<!DOCTYPE HTML>
<!--
	Astral by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Notre joli titre</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper-->
			<div id="wrapper">

				<!-- Nav -->
					<nav id="nav">
						<a href="#home" class="icon solid fa-home"><span>Accueil</span></a>
						<a href="#avis" class="icon solid fa-comments"><span>Avis</span></a>
						<a href="https://github.com/AurelienSH/JADe_project1" class="icon brands fa-github" target=_blank><span>GitHub</span></a>
					</nav>

				<!-- Main -->
				<div id="main">

						<!-- Chercher une oeuvre -->
							<article id="home" class="panel">
								<header>
									<h2>Trouver une oeuvre</h2>
								</header>
								<form action="http://127.0.0.1:8000/submit" method="post" id="inputForm">
									<div>
										<div class="row">
											<div class="col-12">												
												<textarea name="synopsis" id="synopsis" placeholder="Ecrire un synopsis réel ou imaginaire" rows="6"></textarea>
											</div>
											<div class="col-12">
												<input type="submit" value="Trouver les oeuvres similaires" />
											</div>
										</div>
									</div>
								</form>

								<!-- Résultat de la requête -->
								<div id="result"></div>

								<!-- Javascript pour récupérer le résultat de l'API et l'écrire au bon endroit -->
								  <script>
									document.querySelector("#inputForm").onsubmit = async (event) => {
										event.preventDefault() // empêche la page de reload
										const form = event.target
										
										// Récupération de ce qu'on a écrit dans le formulaire
										const data = {
											synopsis: form.querySelector("#synopsis").value,
										}

										console.log(data)
										
										// Définition de la requête POST
										const response = await fetch(
											form.action, // l'url de notre API
											{
												method: "POST",
												headers: {
													"Content-Type": "application/json",
												},
												body: JSON.stringify(data)
											}
											)

										console.log(response)
											
										// récupération du résultat de la requête
										const result = await response.text() // read response body as text
										
										console.log(result)

										// écriture du résultat dans la div avec l'ID "result"
										document.querySelector("#result").innerHTML = result
									}
								  </script>

							</article>

						<!-- Work -->
							<article id="avis" class="panel">
								<header>
									<h2>Avis</h2>
								</header>
								<p>
									Phasellus enim sapien, blandit ullamcorper elementum eu, condimentum eu elit.
									Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia
									luctus elit eget interdum.
								</p>
							</article>

					</div>

				<!-- Footer -->
					<div id="footer">
						<ul class="copyright">
							<li>&copy; Untitled.</li><li>Design : <a href="http://html5up.net" target=_blank>HTML5 UP</a></li>
						</ul>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>